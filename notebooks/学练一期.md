
# 学练一期h5项目总结

- 前端框架：原生js
- 服务端框架：koa2
- 运行平台：开课啦app
- 需求描述：学生在app中观看视频学习中，视频中的某个时间段弹出一个趣味性交互弹窗，弹窗为一个h5页面地址，h5只显示试题题干(涉及到数学公式)，选项内容，底部选择A,B,C,D操作为客户端逻辑；

#### 页面地址请求缓存问题
koa-static默认设置响应头Cache-Control为max-age=0，不用担心html页面迭代后被缓存的问题

#### 页面响应优化问题
通过jsBridge而不是请求java后端接口获取页面内容更加快速

#### 客户端联调遇到的问题
- 安卓协议传输给h5的内容不能超过2k，否则失败（后续项目中遇到，本项目不存在）
- 由于传输的内容为html富文本内容，ios传递给h5的内容为编码过的，需要前端decodeURIComponent解码后再显示
- 公式渲染体验问题，目前使用MathJax.js渲染，渲染过程中会出现闪跳，为避免该问题先隐藏公式内容容器，执行MathJax.Hub.Queue(["Typeset", MathJax.Hub])动态渲染成功(延时1s)后再显示
- 试题公式题干(color:#bbb;)渲染成功隔几秒后，个别安卓机器公式标签颜色变为红色，安卓内核更换后解决
- 题干样式问题，html富文本题干(图片+文字)，要求图片文字水平垂直居中，只能使用flex布局实现，但是其中有br标签，br失效，样式上很难看，如图：
<br />
<img src="../images/1.jpg" width="173" height="98" align=left />
<br />
后与产品沟通后使用正则移除br标签